<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Untitled :: Jakarta EE Documentation</title>
    <meta name="generator" content="Antora 3.1.3">
    <link rel="stylesheet" href="../../../../_/css/site.css">
    <script>var uiRootPath = '../../../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="../../../..">Jakarta EE Documentation</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="#">Home</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Products</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Product A</a>
            <a class="navbar-item" href="#">Product B</a>
            <a class="navbar-item" href="#">Product C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Services</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Service A</a>
            <a class="navbar-item" href="#">Service B</a>
            <a class="navbar-item" href="#">Service C</a>
          </div>
        </div>
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="#">Download</a>
          </span>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="jakarta-ee-docs" data-version="9.1">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../../index.html">Jakarta EE Documentation</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Security</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../security-intro/security-intro.html">Introduction to Security in the Jakarta EE Platform</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../security-webtier/security-webtier.html">Getting Started Securing Web Applications</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../security-jakartaee/security-jakartaee.html">Getting Started Securing Enterprise Applications</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../security-api/security-api.html">Using Jakarta Security</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="security-advanced.html">Jakarta EE Security: Advanced Topics</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Jakarta EE Documentation</span>
    <span class="version">9.1</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="../../../current/index.html">Jakarta EE Documentation</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../current/index.html">10</a>
        </li>
        <li class="version is-current">
          <a href="../../index.html">9.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../jakarta-security-spec/current/security-spec.html">Jakarta Security Specification</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../jakarta-security-spec/current/security-spec.html">3</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../../current/index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
</nav>
<div class="page-versions">
  <button class="version-menu-toggle" title="Show other versions of page">9.1</button>
  <div class="version-menu">
    <a class="version" href="../../../current/security/security-advanced/security-advanced003.html">10</a>
    <a class="version is-current" href="security-advanced003.html">9.1</a>
  </div>
</div>
  <div class="edit-this-page"><a href="https://github.com/virtua-tech/jakartaee-tutorial/edit/antora-prototype-9.1/src/main/docs/modules/security/pages/security-advanced/security-advanced003.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<div class="sect1">
<h2 id="_using_the_jdbc_realm_for_user_authentication"><a class="anchor" href="#_using_the_jdbc_realm_for_user_authentication"></a>Using the JDBC Realm for User Authentication</h2>
<div class="sectionbody">
<div class="paragraph">
<p>An authentication realm, sometimes called a security policy domain or security domain, is a scope over which an application server defines and enforces a common security policy.
A realm contains a collection of users, who may or may not be assigned to a group.
GlassFish Server comes preconfigured with the file, certificate, and administration realms.
An administrator can also set up LDAP, JDBC, digest, or custom realms.</p>
</div>
<div class="paragraph">
<p>An application can specify in its deployment descriptor which realm to use.
If the application does not specify a realm, GlassFish Server uses its default realm, the <code>file</code> realm.
If an application specifies that a JDBC realm is to be used for user authentication, GlassFish Server will retrieve user credentials from a database.
The application server uses the database information and the enabled JDBC realm option in the configuration file.</p>
</div>
<div class="paragraph">
<p>A database provides an easy way to add, edit, or delete users at runtime and enables users to create their own accounts without any administrative assistance.
Using a database has an additional benefit: providing a place to securely store any extra user information.
A realm can be thought of as a database of user names and passwords that identify valid users of a web application or set of web applications with an enumeration of the list of roles associated with each valid user.
Access to specific web application resources is granted to all users in a particular role, instead of enumerating a list of associated users.
A user name can have any number of roles associated with it.</p>
</div>
<div class="paragraph">
<p>Two of the tutorial case studies, <a href="#dukes-tutoring-case-study-example">[dukes-tutoring-case-study-example]</a> and <a href="#dukes-forest-case-study-example">[dukes-forest-case-study-example]</a> use a JDBC realm for user authentication.</p>
</div>
<div class="sect2">
<h3 id="_to_configure_a_jdbc_authentication_realm"><a class="anchor" href="#_to_configure_a_jdbc_authentication_realm"></a>To Configure a JDBC Authentication Realm</h3>
<div class="paragraph">
<p>GlassFish Server enables administrators to specify a user&#8217;s credentials (user name and password) in the JDBC realm instead of in the connection pool.
This prevents other applications from browsing the database tables for user credentials.
By default, storing passwords as clear text is not supported in the JDBC realm.
Under normal circumstances, passwords should not be stored as clear text.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create the database tables in which user credentials for the realm will be stored.</p>
</li>
<li>
<p>Add user credentials to the database tables you created.</p>
</li>
<li>
<p>Create a JDBC connection pool for the database.</p>
<div class="paragraph">
<p>You can use the Administration Console or the command line to create a connection pool.</p>
</div>
</li>
<li>
<p>Create a JDBC resource for the database.</p>
<div class="paragraph">
<p>You can use the Administration Console or the command line to create a JDBC resource.</p>
</div>
</li>
<li>
<p>Create a realm.</p>
<div class="paragraph">
<p>This step needs to associate the resource with the realm, define the tables and columns for users and groups used for authentication, and define the digest algorithm that will be used for storing passwords in the database.</p>
</div>
<div class="paragraph">
<p>You can use the Administration Console or the command line to create a realm.</p>
</div>
</li>
<li>
<p>Modify the deployment descriptor for your application to specify the
JDBC realm.</p>
<div class="ulist">
<ul>
<li>
<p>For an enterprise application in an EAR file, modify the <code>glassfish-application.xml</code> file.</p>
</li>
<li>
<p>For a web application in a WAR file, modify the <code>web.xml</code> file.</p>
</li>
<li>
<p>For an enterprise bean in an EJB JAR file, modify the <code>glassfish-ejb-jar.xml</code> file.</p>
<div class="paragraph">
<p>For example, for a hypothetical application, the <code>web.xml</code> file could specify the <code>jdbcRealm</code> realm, as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;login-config&gt;
    &lt;auth-method&gt;FORM&lt;/auth-method&gt;
    &lt;realm-name&gt;jdbcRealm&lt;/realm-name&gt;
    &lt;form-login-config&gt;
        &lt;form-login-page&gt;/login.xhtml&lt;/form-login-page&gt;
        &lt;form-error-page&gt;/login.xhtml&lt;/form-error-page&gt;
    &lt;/form-login-config&gt;
&lt;/login-config&gt;
&lt;security-constraint&gt;
    &lt;web-resource-collection&gt;
        &lt;web-resource-name&gt;Secure Pages&lt;/web-resource-name&gt;
        &lt;description/&gt;
        &lt;url-pattern&gt;/admin/*&lt;/url-pattern&gt;
    &lt;/web-resource-collection&gt;
    &lt;auth-constraint&gt;
        &lt;role-name&gt;ADMINS&lt;/role-name&gt;
    &lt;/auth-constraint&gt;
&lt;/security-constraint&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Form-based login is specified for all web pages under <code>/admin</code>.
Access to those pages will be allowed only to users in the <code>ADMINS</code> role.</p>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Assign security roles to users or groups of users in the realm.</p>
<div class="paragraph">
<p>To assign a security role to a group or to a user, add a <code>security-role-mapping</code> element to the application server-specific deployment descriptor, in this case <code>glassfish-web.xml</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;security-role-mapping&gt;
    &lt;role-name&gt;USERS&lt;/role-name&gt;
    &lt;group-name&gt;USERS&lt;/group-name&gt;
&lt;/security-role-mapping&gt;
&lt;security-role-mapping&gt;
    &lt;role-name&gt;ADMINS&lt;/role-name&gt;
    &lt;group-name&gt;ADMINS&lt;/group-name&gt;
&lt;/security-role-mapping&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Since GlassFish Server users are assigned to groups during the user creation process, this is more efficient than mapping security roles to individual users.</p>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script id="site-script" src="../../../../_/js/site.js" data-ui-root-path="../../../../_"></script>
<script async src="../../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
